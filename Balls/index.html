<!DOCTYPE html>
<html>
<head>
  <title>Satisfying Bouncing Balls</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.6.0/p5.min.js"></script>
</head>
<body style="margin:0; overflow:hidden;">
<script>
let balls = [];
let radius = 200;

function setup() {
  createCanvas(windowWidth, windowHeight);
  // Start with 3 balls
  for (let i = 0; i < 3; i++) {
    balls.push(new Ball());
  }
}

function draw() {
  background(0);

  // Draw circle boundary
  noFill();
  stroke(255);
  strokeWeight(3);
  ellipse(width/2, height/2, radius * 2);

  // Update all balls
  balls.forEach(b => b.update());

  // Display all balls
  balls.forEach(b => b.display());
}

class Ball {
  constructor(px = width/2, py = height/2) {
    this.pos = createVector(px, py);
    this.vel = p5.Vector.random2D().mult(3);
    this.size = 10;
  }

  update() {
    this.pos.add(this.vel);

    // Distance from center
    let d = dist(this.pos.x, this.pos.y, width/2, height/2);

    // If ball hits boundary â†’ bounce + spawn 2 new balls
    if (d > radius - this.size / 2) {
      // Bounce
      let dir = p5.Vector.sub(this.pos, createVector(width/2, height/2)).normalize();
      this.vel = p5.Vector.reflect(this.vel, dir);

      // Spawn +2 balls
      for (let i = 0; i < 2; i++) {
        balls.push(new Ball(this.pos.x, this.pos.y));
      }
    }
  }

  display() {
    noStroke();
    fill(255);
    drawingContext.shadowBlur = 20;
    drawingContext.shadowColor = "white";
    ellipse(this.pos.x, this.pos.y, this.size);
    drawingContext.shadowBlur = 0;
  }
}

function windowResized() {
  resizeCanvas(windowWidth, windowHeight);
}
</script>
</body>
</html>
